<ws-modal [closeCallback]="closeModal.bind(this)" [maxWidth]="520">
    <div class="pt-3" modalBody>
        <div *ngIf="item && !loading.isRunning(); else loadingTemplate">
            <div class="list-item-info">
                <h1 class="list-item-info__title h5 mb-3">{{ item?.name }} 
                    <span *ngIf="item?.isEntityNew" class="list-item-info__details__new-banner badge badge-danger ml-2">New</span>
                </h1>
                <div class="list-item-info__details">
                    <div class="list-item-info__icons">
                        <span class="list-item-info__icon fas fa-heart" [ngClass]="saved? 'fas selected': ''" (click)="saved? unsaveItem(): saveItem()"></span>
                        <span class="list-item-info__icon fas fa-share-alt" (click)="isShareModalOpened = true"></span>
                        <span class="list-item-info__icon fas fa-store" (click)="navigateToShop()"></span>
                    </div>
                    <div class="list-item-info__price-container">
                        <p class="d-inline-block mr-2 mb-0" *ngIf="currencyService.currencies.length && item?.currency && item?.isOffer && item.priceAfterDiscount != item.price">
                            <span class="list-item-info__details__original-price d-inline-block">
                                <span class="pr-1">{{ currencyService.currencySymbols['MYR'] }}</span>{{ defaultType?.price | currency: currencyService.getCurrencyWithCode(item?.currency).rate: currencyService.getCurrencyWithCode('MYR').rate }}</span>
                        </p>
                        <p class="list-item-info__details__price mb-1" *ngIf="currencyService.currencies.length && item?.currency && !item?.isOffer"><span class="pr-1">{{ currencyService.currencySymbols['MYR'] }}</span>{{ defaultType?.price | currency: currencyService.getCurrencyWithCode(item?.currency).rate: currencyService.getCurrencyWithCode('MYR').rate }}</p>
                        <p class="list-item-info__details__price list-item-info__details__price__offer mb-1" *ngIf="currencyService.currencies.length && item?.currency && item?.isOffer"><span class="pr-1">{{ currencyService.currencySymbols['MYR'] }}</span>{{ defaultType?.price | currency: currencyService.getCurrencyWithCode(item?.currency).rate: currencyService.getCurrencyWithCode('MYR').rate | discountconverter : defaultType?.discount }}</p>
                        <p *ngIf="item?.quantity" class="list-item-info__details__quantity">Quantity: {{ quantity }}</p>
                    </div>
                </div>
                <div class="clearfix mb-3"></div>
                <p *ngIf="item?.description" class="list-item-info__description">{{ item?.description }}</p>
                <div *ngIf="profileImages.length" class="list-item-info__profile-container row no-gutters">
                    <div class="list-item-info__profile mb-2">
                        <swiper #galleryThumbs (indexChange)="onIndexChange($event)" [(index)]="selectedProfileIndex" [config]="{
                            centeredSlides: true,
                            pagination: false,
                            navigation: false}">
                            <div *ngFor="let image of profileImages">
                                <img style="width: 100%; object-fit: contain; height: initial" [src]="environment.IMAGE_URL + image" alt="image"/>
                                <div class="w-100 text-center font-8" style="position: absolute; bottom: 0; line-height: 30px; color: #fff; background-color: #282C35">
                                    <p class="d-inline-block mb-0">
                                        <span *ngIf="currencyService.currencies.length && item?.currency && item?.isOffer && item.priceAfterDiscount != selectedType.price" class="d-inline-block mr-2 font-8" style="text-decoration: line-through; color: #ccc">
                                            <span class="pr-1">{{ currencyService.currencySymbols['MYR'] }}</span>{{ selectedType?.price | currency: currencyService.getCurrencyWithCode(item?.currency).rate: currencyService.getCurrencyWithCode('MYR').rate }}</span>
                                        <span>
                                            <span class="mb-1" *ngIf="currencyService.currencies.length && item?.currency && !item?.isOffer"><span class="pr-1">{{ currencyService.currencySymbols['MYR'] }}</span>{{ selectedType?.price | currency: currencyService.getCurrencyWithCode(item?.currency).rate: currencyService.getCurrencyWithCode('MYR').rate }}</span>
                                            <span class="mb-1" *ngIf="currencyService.currencies.length && item?.currency && item?.isOffer"><span class="pr-1">{{ currencyService.currencySymbols['MYR'] }}</span>{{ selectedType?.price | currency: currencyService.getCurrencyWithCode(item?.currency).rate: currencyService.getCurrencyWithCode('MYR').rate | discountconverter : selectedType?.discount }}</span>
                                        </span>
                                    </p>
                                </div>
                            </div>
                        </swiper>
                        <div class="w-100 py-3" style="position: relative; z-index: 1">
                            <span *ngFor="let type of item.types; let i = index" class="list-item-info__profile-image-container mr-1 mb-1 clickable">
                                <img *ngIf="!type.images?.length" class="list-item-info__profile-image" (click)="selectItemType(type)" src="assets/images/png/profileImage.png" alt="image"/>
                                <img *ngIf="type.images?.length" class="list-item-info__profile-image" (click)="selectItemType(type)" [src]="environment.IMAGE_URL + type.images[0]" alt="image"/>
                                <span *ngIf="type == selectedType" class="list-item-info__profile-image__overlay"></span>
                            </span>
                        </div>
                    </div>
                </div>
                <!-- <div *ngIf="false && item?.description" class="list-item-info__container">
                    <div class="list-item-info__description-image mb-4" *ngFor="let descriptionImage of item?.descriptionImages">
                        <img [src]="environment.IMAGE_URL + descriptionImage" alt="description image" />
                    </div>
                </div> -->
            </div>
        </div>
    </div>
</ws-modal>

<ng-template #loadingTemplate>
    <ws-spinner *ngIf="loading.isRunning(); else noItemTemplate" class="text-center d-block w-100" style="padding-top: 15vh; padding-bottom:15vh"></ws-spinner>
</ng-template>

<ng-template #noItemTemplate>
    <h6 class="text-center mb-0" style="padding-top:28.588vh; padding-bottom:28.588vh">Item not found.<br/>
    <span class="mt-2 d-inline-block">Item might already be unpublished by the page.</span></h6>
</ng-template>

<ws-modal *ngIf="isShareModalOpened" [maxWidth]="500" [(isOpened)]="isShareModalOpened">
    <div modalBody class="share-media__container">
        <h4>Share:</h4>
        <!-- <swiper class="py-4 d-block" [config]="{slidesPerView: 7, spaceBetween: 10, slidesPerGroup: 7, navigation: false, pagination: false}"> -->
            <a class="share-media__icon fb" href="javascript:void(0)" (click)="shareThroughFB()">
                <span class="fab fa-facebook-f"></span>
            </a>
            <a class="share-media__icon twitter" target="_blank" href="{{ shareLinkThroughTwitter }}">
                <span class="fab fa-twitter"></span>
            </a>
            <a class="share-media__icon email" href="{{ shareLinkThroughEmail }}">
                <span class="fas fa-envelope"></span>
            </a>
        <!-- </swiper> -->
        <div class="input-group">
            <input class="form-control" style='background-color: #fff' readonly [value]="link" />
            <div class="input-group-append">
                <button class="input-group-text" [cdkCopyToClipboard]="link">
                    <span class="fas fa-copy"></span>
                </button>
            </div>
        </div>
    </div>
</ws-modal>